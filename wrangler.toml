# wrangler.toml - Arquivo de configuração para Cloudflare Workers

name = "gallyfans-ecosystem"
main = "src/workers/intelligent.ts" # Define um ponto de entrada padrão
compatibility_date = "2024-01-26"

# --- BINDINGS DE AMBIENTE ---

# Binding para o Banco de Dados D1
[[d1_databases]]
binding = "DB" # Nome que será usado no código (ex: env.DB)
database_name = "gallyfans_d1"
database_id = "<seu-database-id-aqui>"
preview_database_id = "gallyfans_d1_preview"

# Binding para o Durable Object que coordena os jobs
[durable_objects]
bindings = [
  { name = "JOB_COORDINATOR", class_name = "JobCoordinator" }
]

# --- WORKERS ---

[[services]]
name = "intelligent-worker"
entrypoint = "src/workers/intelligent.ts"
# Este worker decide o que fazer e cria jobs

[[services]]
name = "content-worker"
entrypoint = "src/workers/content.ts"
# Este worker coleta o conteúdo bruto

[[services]]
name = "director-worker"
entrypoint = "src/workers/director.ts"
# Este worker supervisiona e finaliza os jobs

# --- MIGRAÇÕES DO D1 ---
# Define o diretório onde as migrações do banco de dados D1 serão armazenadas.
[[migrations]]
tag = "v1"
new_classes = ["JobCoordinator"]
